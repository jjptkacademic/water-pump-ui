# ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏õ‡∏±‡πä‡∏°‡∏ô‡πâ‡∏≥‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ - System Documentation

## ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏ö‡∏ö

**‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ:** Water Pump Control System with MQTT
**Platform:** ESP8266 (NodeMCU)
**Communication:** MQTT over WiFi
**Location:** `C:\D\Project\Arduino73\Project\MiniProJect\`

### ‡∏Æ‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏ß‡∏£‡πå

**‡πÄ‡∏ã‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ô‡πâ‡∏≥ (Digital):**
- ‡∏ñ‡∏±‡∏á Park (‡∏ö‡∏ô): SensorinParkDown (D4), SensorinParkUp (D3)
- ‡∏ñ‡∏±‡∏á Pub/Sea (‡∏•‡πà‡∏≤‡∏á): SensorinSeaDown (D2), SensorinSeaUp (D1)

**‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°:**
- ‡∏õ‡∏±‡πä‡∏°‡∏ô‡πâ‡∏≥: Wather_Pump (D7)
- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î: ButtonOn (D5)
- ‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏¥‡∏î: ButtonOff (D6)

**‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå Ultrasonic (‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï):**
- ‡∏à‡∏∞‡πÉ‡∏ä‡πâ MCP23017 GPIO Expander ‡∏ï‡πà‡∏≠ I2C (D1=SCL, D2=SDA)

---

## Logic ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

### 1. Auto Mode (‡πÇ‡∏´‡∏°‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)

**‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç:**
1. ‡∏ñ‡∏±‡∏á Park ‡∏ô‡πâ‡∏≥‡∏•‡∏î‡∏•‡∏á‡∏ñ‡∏∂‡∏á sensor ‡∏•‡πà‡∏≤‡∏á (`parkDownStatus == 1`)
2. ‡∏ñ‡∏±‡∏á Park ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ï‡πá‡∏° (`parkUpStatus == 0`)
3. ‡∏ñ‡∏±‡∏á Pub ‡∏°‡∏µ‡∏ô‡πâ‡∏≥‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ (`seaUpStatus == 1 && seaDownStatus == 0`)

**‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:**
- ‚úÖ ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Ñ‡∏£‡∏ö ‚Üí ‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°
- ‚ùå ‡∏ô‡πâ‡∏≥ Park ‡πÄ‡∏ï‡πá‡∏° OR ‡∏ô‡πâ‡∏≥ Pub ‡∏´‡∏°‡∏î ‚Üí ‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°

**‡πÑ‡∏ü‡∏•‡πå:** `PumpController.cpp`
**‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô:** `checkPumpWorking()` (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 46-76)

```cpp
// ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 48-52: ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏±‡πä‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ)
if (sensor->shouldStopPump()) {  // ‡∏ñ‡∏±‡∏á Park ‡πÄ‡∏ï‡πá‡∏° OR ‡∏ñ‡∏±‡∏á Pub ‡∏´‡∏°‡∏î
    flag_autopump_on = false;
    return false;
}

// ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 64-68: ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
else if (sensor->getParkDownStatus() == 1 &&    // Park ‡∏ô‡πâ‡∏≥‡∏ï‡πà‡∏≥
         sensor->getParkUpStatus() == 0 &&       // Park ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ï‡πá‡∏°
         sensor->isWaterFullInPub()) {           // Pub ‡∏°‡∏µ‡∏ô‡πâ‡∏≥
    flag_autopump_on = true;
    return true;
}
```

---

### 2. Timer Mode (‡πÇ‡∏´‡∏°‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤)

**‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ (‡∏à‡∏≤‡∏Å MQTT):**
- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô: `ptk/esp8266/timer/mon` ‡∏ñ‡∏∂‡∏á `sun` (Payload: "Mon_ON" / "Mon_OFF")
- ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°: `ptk/esp8266/timerstart` (Payload: "06:30")
- ‡πÄ‡∏ß‡∏•‡∏≤‡∏´‡∏¢‡∏∏‡∏î: `ptk/esp8266/timerstop` (Payload: "08:00")

**‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç:**
1. ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (`dayOn_Select[currentDay] == 1`)
2. ‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á start-stop
3. ‡∏ñ‡∏±‡∏á Pub ‡∏°‡∏µ‡∏ô‡πâ‡∏≥ (`seaDownStatus == 0`)
4. ‡∏ñ‡∏±‡∏á Park ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ï‡πá‡∏° (`parkUpStatus == 0`)

**‡πÑ‡∏ü‡∏•‡πå:** `TimeManager.cpp`
**‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô:** `checkTimerPump()` (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 62-107)

```cpp
// ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 73-86: ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏ô‡πâ‡∏≥
if (dayOn_Select[currentDay] == 1) {
    if (currentTimeMinutes >= startTimeMinutes &&
        currentTimeMinutes < stopTimeMinutes &&
        sensor->getSeaDownStatus() == 0 &&      // Pub ‡∏°‡∏µ‡∏ô‡πâ‡∏≥
        sensor->getParkUpStatus() == 0 &&       // Park ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ï‡πá‡∏°
        !flag_keep_timer_pump_working) {

        timerActive = true;  // ‚úÖ ‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°
    }
}
```

**Integration ‡∏Å‡∏±‡∏ö Pump:**
`PumpController.cpp` ‚Üí `checkPumpWorking()` ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 54-57

```cpp
// ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 54-57: ‡∏ñ‡πâ‡∏≤ timer flag ‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà ‡πÉ‡∏´‡πâ‡∏õ‡∏±‡πä‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
else if (flag_timer_pump) {
    Serial.println("‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏Ñ‡∏£‡∏±‡∏ö‡∏û‡∏µ‡πà");
    return true;
}
```

---

### 3. Manual Mode (‡πÇ‡∏´‡∏°‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î)

**‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏Å‡∏≤‡∏£ (‡∏à‡∏≤‡∏Å MQTT ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏∏‡πà‡∏°‡∏à‡∏£‡∏¥‡∏á):**
- MQTT Topic: `ptk/esp8266/btn`
- Payload: "Btn_ON" (‡πÄ‡∏õ‡∏¥‡∏î), "Btn_OFF" (‡∏õ‡∏¥‡∏î)

**‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç:**
- ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î AND ‡∏ñ‡∏±‡∏á Pub ‡∏°‡∏µ‡∏ô‡πâ‡∏≥ AND ‡∏ñ‡∏±‡∏á Park ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ï‡πá‡∏° ‚Üí ‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°
- ‡∏ñ‡πâ‡∏≤‡∏ô‡πâ‡∏≥‡∏´‡∏°‡∏î/‡πÄ‡∏ï‡πá‡∏° ‚Üí ‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á MQTT ‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô OFF

**‡πÑ‡∏ü‡∏•‡πå:** `PumpController.cpp`
**‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô:** `checkButtonPump()` (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 78-104)

```cpp
// ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 82-85: ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏•‡∏∞‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏ô‡πâ‡∏≥
if (Button_Status && !sensor->shouldStopPump()) {
    flag_trigBtn_start = true;  // ‚úÖ ‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°
}

// ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 87-90: ‡∏ñ‡πâ‡∏≤‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏ï‡πà‡∏ô‡πâ‡∏≥‡∏´‡∏°‡∏î/‡πÄ‡∏ï‡πá‡∏°
else if (flag_trigBtn_start && sensor->shouldStopPump()) {
    flag_trigBtn_start = false;  // ‚ùå ‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°
}

// ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 96-103: ‡∏™‡πà‡∏á MQTT ‡πÉ‡∏´‡πâ UI ‡∏õ‡∏¥‡∏î‡∏õ‡∏∏‡πà‡∏°
else if (Button_Status && !flag_trigBtn_start) {
    Button_Status = false;
    client.publish("ptk/esp8266/btn", "Btn_OFF", true);
}
```

**MQTT Handler:**
`MQTTHandler.cpp` ‚Üí `handleCallback()` ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 30-42

```cpp
// ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 30-42: ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏à‡∏≤‡∏Å MQTT
if (topicStr == "ptk/esp8266/btn") {
    if (message == "Btn_ON") {
        pumpCtrl->setButtonStatus(true);
    } else if (message == "Btn_OFF") {
        pumpCtrl->setButtonStatus(false);
    }
}
```

---

## ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç

### üìÑ `MiniProJect.ino` (Main File)

**Setup:** ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 83-114
- 87-88: `waterSensor.init()`, `pumpController.init()` ‚Üí ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô sensors ‡πÅ‡∏•‡∏∞‡∏õ‡∏±‡πä‡∏°
- 91: `setup_wifi()` ‚Üí ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° WiFi
- 94: `timeManager.init()` ‚Üí sync ‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏≤‡∏Å NTP
- 98: `mqttHandler.init()` ‚Üí ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° MQTT broker
- 102-111: ‡πÄ‡∏û‡∏¥‡πà‡∏° tasks ‡πÄ‡∏Ç‡πâ‡∏≤ scheduler

**Loop:** ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 116-119
- 117: `mqttHandler.loop()` ‚Üí ‡∏£‡∏±‡∏Å‡∏©‡∏≤ MQTT connection
- 118: `runner.execute()` ‚Üí ‡∏£‡∏±‡∏ô scheduled tasks

**Tasks:**
- 78: `sensorReadTask` (200ms) ‚Üí ‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏ã‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå
- 79: `checkPumpTask` (500ms) ‚Üí ‡πÄ‡∏ä‡πá‡∏Ñ auto mode
- 80: `btnTask` (500ms) ‚Üí ‡πÄ‡∏ä‡πá‡∏Ñ‡∏õ‡∏∏‡πà‡∏°
- 81: `timerTask` (500ms) ‚Üí ‡πÄ‡∏ä‡πá‡∏Ñ timer

---

### üìÑ `WaterSensor.cpp`

**`init()`** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 16-21)
- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ pinMode ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ã‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå 4 ‡∏ï‡∏±‡∏ß

**`read()`** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 23-28)
- ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤ digitalRead ‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á 4 ‡∏ï‡∏±‡∏ß

**`isWaterFullInPub()`** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 30-32)
- Return: `seaUpStatus == 1 && seaDownStatus == 0`
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢: ‡∏ô‡πâ‡∏≥‡πÉ‡∏ô‡∏ñ‡∏±‡∏á Pub ‡πÄ‡∏ï‡πá‡∏°‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ

**`shouldStopPump()`** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 34-36)
- Return: `seaDownStatus == 1 || parkUpStatus == 1`
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢: ‡∏ô‡πâ‡∏≥ Pub ‡∏´‡∏°‡∏î ‡∏´‡∏£‡∏∑‡∏≠ Park ‡πÄ‡∏ï‡πá‡∏°

**`publishLevels()`** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 38-82)
- 42-60: Publish ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥ Pub (0=‡∏´‡∏°‡∏î, 1=‡∏Ñ‡∏£‡∏∂‡πà‡∏á, 2=‡πÄ‡∏ï‡πá‡∏°)
- 63-81: Publish ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥ Park (0=‡∏´‡∏°‡∏î, 1=‡∏Ñ‡∏£‡∏∂‡πà‡∏á, 2=‡πÄ‡∏ï‡πá‡∏°)
- MQTT Topics: `ptk/esp8266/water-level-pub`, `ptk/esp8266/water-level-park`

---

### üìÑ `PumpController.cpp`

**`openPump()`** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 24-33)
- 26: `digitalWrite(Wather_Pump, HIGH)` ‚Üí ‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°
- 27-28: Publish MQTT: `Led_ON`, `Btn_ON`

**`offPump()`** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 35-44)
- 36: `digitalWrite(Wather_Pump, LOW)` ‚Üí ‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°
- 39-40: Publish MQTT: `Led_OFF`, `Btn_OFF`

**`checkPumpWorking()`** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 46-76)
- **‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:**
  1. Safety check (48-52) ‚Üí ‡∏´‡∏¢‡∏∏‡∏î‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢
  2. Timer mode (54-57) ‚Üí ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏•‡∏≤
  3. Button mode (59-62) ‚Üí ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡∏õ‡∏∏‡πà‡∏°
  4. Auto mode (64-68) ‚Üí ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡πÄ‡∏ã‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå
  5. Continue pumping (70-73) ‚Üí ‡∏õ‡∏±‡πä‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á

**`checkAutoPump()`** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 106-124)
- 109-114: ‡∏ñ‡πâ‡∏≤ auto mode ‡πÄ‡∏õ‡∏¥‡∏î ‚Üí ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `checkPumpWorking()` ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏õ‡∏±‡πä‡∏°
- 115-123: ‡∏ñ‡πâ‡∏≤ auto mode ‡∏õ‡∏¥‡∏î ‚Üí ‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°‡πÅ‡∏•‡∏∞ publish MQTT

---

### üìÑ `TimeManager.cpp`

**`init()`** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 24-31)
- 25-27: ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô NTP client ‡πÅ‡∏•‡∏∞ sync ‡πÄ‡∏ß‡∏•‡∏≤
- 30: ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô

**`updateNTPTime()`** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 33-39)
- ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏∏‡∏Å 1 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á (NTP_INTERVAL)

**`getCurrentTimeMinutes()`** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 41-44)
- ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏≤‡∏ó‡∏µ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡∏Ñ‡∏∑‡∏ô (‡πÄ‡∏ä‡πà‡∏ô 06:30 = 390)

**`getCurrentDay()`** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 46-50)
- Return: 0=‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå, 1=‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£, ..., 6=‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå

**`checkTimerPump()`** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 62-107)
- 73-86: ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡∏¥‡∏î ‡πÅ‡∏•‡∏∞‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤
- 88-92: ‡∏ñ‡πâ‡∏≤‡∏õ‡∏±‡πä‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡πâ‡∏≥‡πÄ‡∏ï‡πá‡∏°/‡∏´‡∏°‡∏î ‚Üí ‡∏´‡∏¢‡∏∏‡∏î
- 94-99: ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‚Üí ‡∏õ‡∏¥‡∏î flag

---

### üìÑ `MQTTHandler.cpp`

**`init()`** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 11-13)
- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ broker address ‡πÅ‡∏•‡∏∞ port

**`handleCallback()`** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 15-106)
- **Button control** (30-42): ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á Btn_ON/OFF
- **Debug mode** (44-56): ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î serial debug
- **Auto mode** (58-70): ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î auto mode
- **Timer start/stop** (72-82): ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°-‡∏´‡∏¢‡∏∏‡∏î
- **Day selection** (84-105): ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (Mon-Sun)

**`reconnect()`** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 108-139)
- 114: ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ MQTT broker
- 118-131: Subscribe topics ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

**`loop()`** (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 141-146)
- ‡πÄ‡∏ä‡πá‡∏Ñ‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏Å‡∏©‡∏≤ MQTT connection

---

## MQTT Topics

### ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å (ESP8266 ‚Üí App)

| Topic | Payload | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
|-------|---------|----------|
| `ptk/esp8266/water-level-park` | "0", "1", "2" | ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏ñ‡∏±‡∏á Park (0=‡∏´‡∏°‡∏î, 1=‡∏Ñ‡∏£‡∏∂‡πà‡∏á, 2=‡πÄ‡∏ï‡πá‡∏°) |
| `ptk/esp8266/water-level-pub` | "0", "1", "2" | ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏ñ‡∏±‡∏á Pub (0=‡∏´‡∏°‡∏î, 1=‡∏Ñ‡∏£‡∏∂‡πà‡∏á, 2=‡πÄ‡∏ï‡πá‡∏°) |
| `ptk/esp8266/status` | "Led_ON", "Led_OFF" | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡πä‡∏° |
| `ptk/esp8266/btn` | "Btn_ON", "Btn_OFF" | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏∏‡πà‡∏° |
| `ptk/esp8266/deug` | text messages | ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° debug |

### ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤ (App ‚Üí ESP8266)

| Topic | Payload | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
|-------|---------|----------|
| `ptk/esp8266/btn` | "Btn_ON", "Btn_OFF" | ‡∏™‡∏±‡πà‡∏á‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠ |
| `ptk/esp8266/set-debug` | "D_ON", "D_OFF" | ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î debug mode |
| `ptk/esp8266/set-auto` | "Auto_ON", "Auto_OFF" | ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î auto mode |
| `ptk/esp8266/timerstart` | "06:30" | ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏±‡πä‡∏° |
| `ptk/esp8266/timerstop` | "08:00" | ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏±‡πä‡∏° |
| `ptk/esp8266/timer/mon` ‡∏ñ‡∏∂‡∏á `sun` | "Mon_ON", "Mon_OFF" | ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô |

---

## Flow ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Main Loop (runner.execute)              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ           ‚îÇ           ‚îÇ            ‚îÇ
         ‚ñº           ‚ñº           ‚ñº            ‚ñº
   SensorRead   CheckPump   CheckBtn   CheckTimer
   (200ms)      (500ms)     (500ms)    (500ms)
         ‚îÇ           ‚îÇ           ‚îÇ            ‚îÇ
         ‚ñº           ‚îÇ           ‚îÇ            ‚îÇ
  Read sensors       ‚îÇ           ‚îÇ            ‚îÇ
  Publish MQTT       ‚îÇ           ‚îÇ            ‚îÇ
         ‚îÇ           ‚îÇ           ‚îÇ            ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚ñº
            checkPumpWorking()
                     ‚îÇ
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ           ‚îÇ           ‚îÇ            ‚îÇ
         ‚ñº           ‚ñº           ‚ñº            ‚ñº
      Safety      Timer       Button       Auto
      Check       Flag        Flag         Mode
         ‚îÇ           ‚îÇ           ‚îÇ            ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ
                     ‚ñº
              openPump() / offPump()
                     ‚îÇ
                     ‚ñº
              Publish MQTT Status
```

---

## ‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° Ultrasonic Sensors (‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï)

**‡πÅ‡∏ú‡∏ô‡πÄ‡∏ï‡πá‡∏°:** `C:\D\Project\Arduino73\ULTRASONIC_IMPLEMENTATION_PLAN.md`

**‡∏™‡∏£‡∏∏‡∏õ:**
- ‡πÄ‡∏û‡∏¥‡πà‡∏° MCP23017 GPIO Expander (I2C)
- HC-SR04 x2 ‡∏ß‡∏±‡∏î‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥ 0-100%
- Hybrid mode: Digital sensors (safety) + Ultrasonic (monitoring)
- MQTT topics ‡πÉ‡∏´‡∏°‡πà:
  - `ptk/esp8266/ultrasonic/park/percent`
  - `ptk/esp8266/ultrasonic/pub/percent`
  - `ptk/esp8266/ultrasonic/threshold/*` (‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤)

---

## ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏´‡∏°‡∏î‡πÉ‡∏´‡∏°‡πà "Force Stop"

**1. ‡πÄ‡∏û‡∏¥‡πà‡∏° flag ‡πÉ‡∏ô PumpController.h:**
```cpp
private:
    bool flag_force_stop;  // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
```

**2. ‡πÅ‡∏Å‡πâ checkPumpWorking() ‡πÉ‡∏ô PumpController.cpp:**
```cpp
bool PumpController::checkPumpWorking() {
    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
    if (flag_force_stop) {
        return false;  // ‡∏´‡∏¢‡∏∏‡∏î‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
    }
    // ... existing code ...
}
```

**3. ‡πÄ‡∏û‡∏¥‡πà‡∏° MQTT handler ‡πÉ‡∏ô MQTTHandler.cpp:**
```cpp
void MQTTHandler::handleCallback(...) {
    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô handleCallback
    else if (topicStr == "ptk/esp8266/force-stop") {
        if (message == "STOP") {
            pumpCtrl->setForceStop(true);
        }
    }
}
```

**4. Subscribe topic ‡πÉ‡∏ô reconnect():**
```cpp
client->subscribe("ptk/esp8266/force-stop");
```

‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏Å‡πá‡πÄ‡∏™‡∏£‡πá‡∏à! ‡∏™‡πà‡∏á MQTT: `ptk/esp8266/force-stop` = "STOP" ‡∏õ‡∏±‡πä‡∏°‡∏à‡∏∞‡∏´‡∏¢‡∏∏‡∏î‡∏ó‡∏±‡∏ô‡∏ó‡∏µ

---

## ‡∏Å‡∏≤‡∏£ Debug

### Serial Monitor Messages:

```
‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß                  // setup() ‡πÄ‡∏™‡∏£‡πá‡∏à
‡∏ô‡πâ‡∏≥‡πÄ‡∏ï‡πá‡∏°‡∏Ñ‡∏•‡∏≠‡∏á                           // seaUpStatus == 1
‡∏ô‡πâ‡∏≥‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏Ñ‡∏•‡∏≠‡∏á                          // seaDownStatus == 0
‡∏ô‡πâ‡∏≥‡∏´‡∏°‡∏î‡∏Ñ‡∏•‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß                        // seaDownStatus == 1
‡∏õ‡∏±‡πä‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô                            // openPump()
‡∏õ‡∏±‡πä‡∏°‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô                         // offPump()
‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏Ñ‡∏£‡∏±‡∏ö‡∏û‡∏µ‡πà                // Timer mode active
‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏°‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏Ñ‡∏£‡∏±‡∏ö‡∏ô‡∏≤‡∏¢         // Button mode active
‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏•‡∏¢       // Auto mode active
```

### ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡πà‡∏≤‡∏ô MQTT:
```bash
# Subscribe ‡∏ó‡∏∏‡∏Å topics
mosquitto_sub -h <broker> -t "ptk/esp8266/#" -u esp8266ptk -P Aa12341234
```

---

## Configuration

**WiFi:** `config.cpp` ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 4-5
```cpp
const char* ssid = "Nebula";
const char* password = "teacherRoom";
```

**MQTT:** `config.cpp` ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 8-11
```cpp
const char* mqtt_server = "6555a54274d6454ab49e8eb9b94c325c.s1.eu.hivemq.cloud";
const char* mqtt_username = "esp8266ptk";
const char* mqtt_password = "Aa12341234";
const int mqtt_port = 8883;
```

**NTP:** `config.cpp` ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 14-15
```cpp
const long utcOffsetInSeconds = 25200;  // UTC+7 Thailand
const unsigned long NTP_INTERVAL = 3600000;  // 1 hour
```

**Task Intervals:** `config.h` ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 28-31
```cpp
#define SENSOR_READ_INTERVAL 200   // ‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏ã‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏∏‡∏Å 200ms
#define PUMP_CHECK_INTERVAL 500    // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏õ‡∏±‡πä‡∏°‡∏ó‡∏∏‡∏Å 500ms
#define BTN_CHECK_INTERVAL 500     // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏∏‡∏Å 500ms
#define TIMER_CHECK_INTERVAL 500   // ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏∏‡∏Å 500ms
```

---

## ‡∏™‡∏£‡∏∏‡∏õ

‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô **Event-driven architecture** ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ:
- **TaskScheduler** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö non-blocking tasks
- **MQTT** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö remote control ‡πÅ‡∏•‡∏∞ monitoring
- **State flags** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ priorities ‡∏Ç‡∏≠‡∏á‡πÇ‡∏´‡∏°‡∏î‡∏ï‡πà‡∏≤‡∏á‡πÜ
- **Safety-first design** - ‡πÄ‡∏ä‡πá‡∏Ñ safety ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏™‡∏°‡∏≠

**Priority Order:** Safety > Timer > Button > Auto > Continue
